@import "tailwindcss";

/* ====================================
   CSS Custom Properties (Design Tokens)
   ==================================== */
:root {
  /* Colors */
  --background: #ffffff;
  --foreground: #171717;
  
  /* Focus styles */
  --focus-ring-color: #ffffff;
  --focus-ring-offset: 2px;
  --focus-ring-width: 3px;
  
  /* Touch targets (WCAG 2.1 AA: minimum 44x44px) */
  --touch-target-min: 44px;
  --touch-target-comfortable: 48px;
  
  /* Transitions */
  --transition-fast: 150ms;
  --transition-normal: 200ms;
  --transition-slow: 300ms;
  
  /* Slider dimensions */
  --slider-height: 16px;
  --slider-thumb-size: 32px;
  --slider-thumb-size-touch: 44px;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

/* ====================================
   Base Styles
   ==================================== */
html {
  /* Smooth scrolling with reduced motion fallback */
  scroll-behavior: smooth;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
  /* Prevent layout shift from scrollbars */
  scrollbar-gutter: stable;
}

/* ====================================
   Screen Reader Only (Visually Hidden)
   ==================================== */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Allow sr-only elements to become visible on focus */
.sr-only-focusable:focus,
.sr-only-focusable:active {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ====================================
   Focus Styles (WCAG 2.1 AA Compliant)
   ==================================== */

/* Remove default outline, we'll add custom focus-visible styles */
*:focus {
  outline: none;
}

/* Visible focus ring for keyboard navigation */
*:focus-visible {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
  border-radius: 4px;
}

/* Enhanced focus for interactive elements */
button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[role="button"]:focus-visible,
[tabindex]:focus-visible {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
  box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
  transition: box-shadow var(--transition-fast) ease-out;
}

/* Slider-specific focus styles */
input[type="range"]:focus-visible {
  outline: none;
  box-shadow: none;
}

input[type="range"]:focus-visible::-webkit-slider-thumb {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: 2px;
  box-shadow: 0 0 0 8px rgba(255, 255, 255, 0.3);
}

input[type="range"]:focus-visible::-moz-range-thumb {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: 2px;
  box-shadow: 0 0 0 8px rgba(255, 255, 255, 0.3);
}

/* ====================================
   Enhanced Range Slider Styles
   ==================================== */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: var(--slider-height);
  border-radius: 9999px;
  outline: none;
  background: transparent;
  cursor: pointer;
  /* Ensure touch target height meets WCAG requirements */
  padding: calc((var(--touch-target-min) - var(--slider-height)) / 2) 0;
  margin: 0;
  touch-action: pan-x;
}

/* Webkit (Chrome, Safari, Edge) slider thumb */
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: var(--slider-thumb-size);
  height: var(--slider-thumb-size);
  border-radius: 50%;
  background: white;
  cursor: pointer;
  border: 3px solid rgba(0, 0, 0, 0.1);
  box-shadow: 
    0 2px 8px rgba(0, 0, 0, 0.3),
    0 0 0 0 transparent;
  transition: 
    transform var(--transition-fast) ease-out,
    box-shadow var(--transition-fast) ease-out;
  /* Ensure minimum touch target */
  min-width: var(--touch-target-min);
  min-height: var(--touch-target-min);
}

input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.15);
  box-shadow: 
    0 4px 12px rgba(0, 0, 0, 0.4),
    0 0 0 4px rgba(255, 255, 255, 0.2);
}

input[type="range"]::-webkit-slider-thumb:active {
  transform: scale(1.1);
  box-shadow: 
    0 2px 6px rgba(0, 0, 0, 0.3),
    0 0 0 6px rgba(255, 255, 255, 0.3);
}

/* Disabled state */
input[type="range"]:disabled::-webkit-slider-thumb {
  cursor: not-allowed;
  opacity: 0.5;
  transform: none;
}

/* Firefox slider thumb */
input[type="range"]::-moz-range-thumb {
  width: var(--slider-thumb-size);
  height: var(--slider-thumb-size);
  border-radius: 50%;
  background: white;
  cursor: pointer;
  border: 3px solid rgba(0, 0, 0, 0.1);
  box-shadow: 
    0 2px 8px rgba(0, 0, 0, 0.3),
    0 0 0 0 transparent;
  transition: 
    transform var(--transition-fast) ease-out,
    box-shadow var(--transition-fast) ease-out;
}

input[type="range"]::-moz-range-thumb:hover {
  transform: scale(1.15);
  box-shadow: 
    0 4px 12px rgba(0, 0, 0, 0.4),
    0 0 0 4px rgba(255, 255, 255, 0.2);
}

input[type="range"]::-moz-range-thumb:active {
  transform: scale(1.1);
  box-shadow: 
    0 2px 6px rgba(0, 0, 0, 0.3),
    0 0 0 6px rgba(255, 255, 255, 0.3);
}

input[type="range"]:disabled::-moz-range-thumb {
  cursor: not-allowed;
  opacity: 0.5;
  transform: none;
}

/* Firefox range track */
input[type="range"]::-moz-range-track {
  height: var(--slider-height);
  border-radius: 9999px;
  background: rgba(255, 255, 255, 0.2);
}

/* ====================================
   Touch Target Improvements
   ==================================== */

/* Ensure all interactive elements meet minimum touch target size */
button,
a,
[role="button"],
.game-button,
.game-mode-button {
  min-height: var(--touch-target-min);
  min-width: var(--touch-target-min);
}

/* Add touch-friendly padding to clickable elements */
.game-button {
  padding: 16px 24px;
  /* Increase tap target area without changing visual size */
  position: relative;
}

.game-button::before {
  content: '';
  position: absolute;
  top: -8px;
  right: -8px;
  bottom: -8px;
  left: -8px;
}

/* Slider container touch improvements */
.slider-container {
  /* Compact on mobile, larger on desktop */
  min-height: 52px;
  padding: 8px 12px;
}

@media (min-width: 640px) {
  .slider-container {
    min-height: 70px;
    padding: 12px 16px;
  }
}

.slider-track-container {
  /* Ensure the track area is easy to tap */
  min-height: var(--touch-target-min);
  display: flex;
  align-items: center;
  position: relative;
}

/* ====================================
   Color Swatch Accessibility
   ==================================== */
.color-swatch {
  /* Minimum size for color perception - compact on mobile */
  min-width: 80px;
  min-height: 56px;
}

@media (min-width: 640px) {
  .color-swatch {
    min-width: 100px;
    min-height: 80px;
  }
}

/* Color comparison layout */
.color-comparison {
  gap: 8px;
}

@media (min-width: 640px) {
  .color-comparison {
    gap: 16px;
  }
}

@media (min-width: 768px) {
  .color-comparison {
    gap: 24px;
  }
}

/* ====================================
   Prefers Reduced Motion
   ==================================== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  /* Disable confetti and other visual effects */
  .animate-pulse {
    animation: none !important;
  }
  
  /* Keep essential state changes visible but instant */
  input[type="range"]::-webkit-slider-thumb {
    transition: none;
  }
  
  input[type="range"]::-moz-range-thumb {
    transition: none;
  }
  
  /* Disable motion on hover/focus states */
  button:hover,
  a:hover,
  [role="button"]:hover {
    transform: none !important;
  }
}

/* ====================================
   High Contrast Mode Support
   ==================================== */
@media (prefers-contrast: more) {
  :root {
    --focus-ring-width: 4px;
    --focus-ring-color: #ffffff;
  }
  
  /* Increase text contrast */
  .text-white\/60,
  .text-white\/70,
  .text-white\/80 {
    color: rgba(255, 255, 255, 0.95) !important;
  }
  
  /* Stronger borders */
  .border-white\/20 {
    border-color: rgba(255, 255, 255, 0.6) !important;
  }
  
  /* More visible backgrounds */
  .bg-white\/10,
  .bg-white\/20 {
    background-color: rgba(255, 255, 255, 0.25) !important;
  }
  
  /* Ensure slider thumb is highly visible */
  input[type="range"]::-webkit-slider-thumb {
    border: 4px solid #000000;
    box-shadow: 0 0 0 2px #ffffff;
  }
  
  input[type="range"]::-moz-range-thumb {
    border: 4px solid #000000;
    box-shadow: 0 0 0 2px #ffffff;
  }
  
  /* Show high-contrast color labels */
  .high-contrast\:block {
    display: block !important;
  }
  
  .high-contrast\:flex {
    display: flex !important;
  }
}

/* Windows High Contrast Mode (forced colors) */
@media (forced-colors: active) {
  /* Use system colors */
  button,
  a,
  input[type="range"] {
    forced-color-adjust: none;
  }
  
  /* Ensure focus is visible */
  *:focus-visible {
    outline: 3px solid CanvasText !important;
    outline-offset: 2px;
  }
  
  /* Color swatches need visible borders */
  .color-swatch {
    border: 3px solid CanvasText !important;
  }
  
  /* Slider thumb visibility */
  input[type="range"]::-webkit-slider-thumb {
    background: ButtonFace;
    border: 2px solid ButtonText;
  }
  
  input[type="range"]::-moz-range-thumb {
    background: ButtonFace;
    border: 2px solid ButtonText;
  }
}

/* ====================================
   Score Display Enhancements
   ==================================== */
.score-display {
  /* Compact on mobile, prominent on desktop */
  min-height: 52px;
}

@media (min-width: 640px) {
  .score-display {
    min-height: 80px;
  }
}

/* Tabular numbers for consistent score display */
.tabular-nums {
  font-variant-numeric: tabular-nums;
}

/* ====================================
   Keyboard Navigation Helpers
   ==================================== */

/* Skip link styling */
a[href="#game-modes"]:focus,
a[href="#accessibility-info"]:focus {
  position: fixed;
  top: 16px;
  left: 16px;
  z-index: 9999;
  padding: 16px 24px;
  background: white;
  color: black;
  font-weight: bold;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  text-decoration: none;
}

/* Keyboard shortcut indicators */
kbd {
  display: inline-block;
  padding: 2px 6px;
  font-family: ui-monospace, monospace;
  font-size: 0.875em;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* ====================================
   Mobile Responsive Adjustments
   ==================================== */
@media (max-width: 640px) {
  :root {
    /* Touch targets on mobile - 44px meets WCAG, don't over-inflate */
    --slider-thumb-size: 36px;
    --touch-target-min: 44px;
  }
  
  /* DO NOT stack buttons - keep horizontal for space efficiency */
  /* Removed: .flex.gap-3 { flex-direction: column; } */
  
  /* Slightly smaller text on mobile for density */
  .text-sm {
    font-size: 0.8125rem;
  }
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  :root {
    --slider-thumb-size: 36px;
  }
  
  /* Remove hover effects on touch devices */
  input[type="range"]::-webkit-slider-thumb:hover {
    transform: none;
  }
  
  input[type="range"]::-moz-range-thumb:hover {
    transform: none;
  }
  
  /* Touch targets - 44px is WCAG AA compliant, don't over-inflate */
  button,
  .game-button,
  .game-mode-button {
    min-height: 44px;
  }
}

/* ====================================
   Print Styles
   ==================================== */
@media print {
  /* Hide interactive elements */
  button,
  input[type="range"],
  nav {
    display: none !important;
  }
  
  /* Show color values as text */
  .color-swatch::after {
    content: attr(aria-label);
    display: block;
    padding: 8px;
    font-size: 12px;
  }
}

/* ====================================
   Animation Utilities
   ==================================== */

/* Subtle pulse for low-time warning (respects reduced motion) */
@keyframes gentle-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.animate-pulse {
  animation: gentle-pulse 1s ease-in-out infinite;
}

/* ====================================
   Utility Classes
   ==================================== */

/* High contrast mode visibility toggles */
.high-contrast\:block {
  display: none;
}

.high-contrast\:flex {
  display: none;
}

/* Ensure focus styles are visible in all color schemes */
@media (prefers-color-scheme: light) {
  :root {
    --focus-ring-color: #6366f1;
  }
}
